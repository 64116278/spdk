<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>SPDK Userspace NVMe Driver: nvme_impl.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">SPDK Userspace NVMe Driver
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a2d62a8e784c61036347523257d68417.html">nvme</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">nvme_impl.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:adf50014ff34581ab6ea90c1aee4422e1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme__impl_8h.html#adf50014ff34581ab6ea90c1aee4422e1">nvme_free</a>(buf)&#160;&#160;&#160;rte_free(buf)</td></tr>
<tr class="separator:adf50014ff34581ab6ea90c1aee4422e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a134486689372a4cf5da51b000e4be9ea"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme__impl_8h.html#a134486689372a4cf5da51b000e4be9ea">nvme_printf</a>(ctrlr,  fmt,  args...)&#160;&#160;&#160;printf(fmt, ##args)</td></tr>
<tr class="separator:a134486689372a4cf5da51b000e4be9ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ae8097496a5de1cbe302845645c9faf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme__impl_8h.html#a8ae8097496a5de1cbe302845645c9faf">nvme_assert</a>(check,  str)&#160;&#160;&#160;assert(check)</td></tr>
<tr class="separator:a8ae8097496a5de1cbe302845645c9faf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a113be6337ce6831ae8bfc95d8dcd9901"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme__impl_8h.html#a113be6337ce6831ae8bfc95d8dcd9901">nvme_vtophys</a>(buf)&#160;&#160;&#160;vtophys(buf)</td></tr>
<tr class="separator:a113be6337ce6831ae8bfc95d8dcd9901"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a475a59bf7670eac1bc0ed8f317b81610"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme__impl_8h.html#a475a59bf7670eac1bc0ed8f317b81610">nvme_alloc_request</a>(bufp)&#160;&#160;&#160;rte_mempool_get(request_mempool, (void **)(bufp));</td></tr>
<tr class="separator:a475a59bf7670eac1bc0ed8f317b81610"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a964075ffde5231b255d681c975f716b7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme__impl_8h.html#a964075ffde5231b255d681c975f716b7">nvme_dealloc_request</a>(buf)&#160;&#160;&#160;rte_mempool_put(request_mempool, buf)</td></tr>
<tr class="separator:a964075ffde5231b255d681c975f716b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca028b40dcafa114ae530e6f8c18e892"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme__impl_8h.html#aca028b40dcafa114ae530e6f8c18e892">nvme_copy_command</a>(dst,  src)&#160;&#160;&#160;rte_memcpy((dst), (src), sizeof(struct <a class="el" href="structnvme__command.html">nvme_command</a>))</td></tr>
<tr class="separator:aca028b40dcafa114ae530e6f8c18e892"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6c242cd22416a947cbf420309c3421df"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme__impl_8h.html#a6c242cd22416a947cbf420309c3421df">nvme_malloc</a> (const char *tag, size_t size, unsigned align, uint64_t *phys_addr)</td></tr>
<tr class="separator:a6c242cd22416a947cbf420309c3421df"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file describes the callback functions required to integrate the userspace NVMe driver for a specific implementation. This implementation is specific for DPDK for Storage. Users would revise it as necessary for their own particular environment if not using it within the DPDK for Storage framework. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a475a59bf7670eac1bc0ed8f317b81610"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define nvme_alloc_request</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">bufp</td><td>)</td>
          <td>&#160;&#160;&#160;rte_mempool_get(request_mempool, (void **)(bufp));</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a buffer for an <a class="el" href="structnvme__request.html">nvme_request</a> object. These objects are allocated for each I/O. They do not need to be pinned nor physically contiguous. </p>

</div>
</div>
<a class="anchor" id="a8ae8097496a5de1cbe302845645c9faf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define nvme_assert</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">check, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">str&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;assert(check)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Assert a condition and panic/abort as desired. Failures of these assertions indicate catastrophic failures within the driver. </p>

</div>
</div>
<a class="anchor" id="aca028b40dcafa114ae530e6f8c18e892"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define nvme_copy_command</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">dst, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">src&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;rte_memcpy((dst), (src), sizeof(struct <a class="el" href="structnvme__command.html">nvme_command</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Copy a struct <a class="el" href="structnvme__command.html">nvme_command</a> from one memory location to another. </p>

</div>
</div>
<a class="anchor" id="a964075ffde5231b255d681c975f716b7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define nvme_dealloc_request</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">buf</td><td>)</td>
          <td>&#160;&#160;&#160;rte_mempool_put(request_mempool, buf)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free a buffer previously allocated with <a class="el" href="nvme__impl_8h.html#a475a59bf7670eac1bc0ed8f317b81610">nvme_alloc_request()</a>. </p>

</div>
</div>
<a class="anchor" id="adf50014ff34581ab6ea90c1aee4422e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define nvme_free</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">buf</td><td>)</td>
          <td>&#160;&#160;&#160;rte_free(buf)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free a memory buffer previously allocated with nvme_malloc. </p>

</div>
</div>
<a class="anchor" id="a134486689372a4cf5da51b000e4be9ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define nvme_printf</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ctrlr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fmt, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">args...&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;printf(fmt, ##args)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Log or print a message from the NVMe driver. </p>

</div>
</div>
<a class="anchor" id="a113be6337ce6831ae8bfc95d8dcd9901"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define nvme_vtophys</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">buf</td><td>)</td>
          <td>&#160;&#160;&#160;vtophys(buf)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the physical address for the specified virtual address. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a6c242cd22416a947cbf420309c3421df"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* nvme_malloc </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>align</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *&#160;</td>
          <td class="paramname"><em>phys_addr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Allocate a pinned, physically contiguous memory buffer with the given size and alignment. Note: these calls are only made during driver initialization. Per I/O allocations during driver operation use the nvme_alloc_request callback. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Nov 4 2015 14:55:13 for SPDK Userspace NVMe Driver by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
